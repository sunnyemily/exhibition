<!DOCTYPE html>
<html class="x-admin-sm" lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>添加届次信息</title>
		<meta content="webkit" name="renderer">
		<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
		<meta content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8" name="viewport"/>
		<link rel="stylesheet" href="/manage/css/xadmin.css">
		<link href="/manage/css/style.css?v=4.1.0" rel="stylesheet">
		<link href="/manage/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
		<link rel="stylesheet" href="/manage/layui/css/layui.css"  media="all">
	</head>
	<body class="gray-bg">
		<div class="modal inmodal" id="friendlink-model">
			<div class="modal-content animated bounceInUp">
				<div class="ibox-content">
					<fieldset class="layui-elem-field layui-field-title" style="border-top:0px">
						<form class="layui-form layui-form-pane" lay-filter='test1' action="">
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="exhibitionid"><span style='color:red'>*</span>所属展会 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<select lay-filter="demo" id="exhibitionid" name="exhibitionid" lay-verify="required">
											<option value="">==请选择==</option>
										</select>
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="sessionid"><span style='color:red'>*</span>届次名 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" lay-verify="required" autocomplete="off" id="sessionid" name="sessionid"
										type="text">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="remark"> 备注 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" id="remark" name="remark"
										type="text">
									</div>
								</div>
							</div>							
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="siteHeadLogo"> 网站顶部logo </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block radioborder" style="width:80%">
										<div class="layui-input-inline" style="width:100%;display:none">
							                <input id="siteHeadLogo" name="siteHeadLogo" readonly type="text" class="layui-input" >               
							              </div>
							              <div class="layui-input-inline" style="padding-left:5px">
							                <button type="button" class="layui-btn" id="uploadPictrue1">
							                  <i class="layui-icon">&#xe67c;</i>上传图片
							                </button>
							                <button type="button" class="layui-btn layui-btn-primary" style="display:none" id="yulanimg1">
							                  	预览
							                </button>
							              </div>										
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="siteSmartLogo"> 网站小logo</label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block radioborder" style="width:80%">
										<div class="layui-input-inline" style="width:100%;display:none">
							                <input id="siteSmartLogo" name="siteSmartLogo" readonly type="text" class="layui-input" >               
							              </div>
							              <div class="layui-input-inline" style="padding-left:5px">
							                <button type="button" class="layui-btn" id="uploadPictrue2">
							                  <i class="layui-icon">&#xe67c;</i>上传图片
							                </button>
							                <button type="button" class="layui-btn layui-btn-primary" style="display:none" id="yulanimg2">
							                  	预览
							                </button>
							              </div>
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="purchaserRegisterStatus"> 采购商注册状态</label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block radioborder" style="width:80%">
										<input type='radio' name='purchaserRegisterStatus' value='1' title='开'>
										<input type='radio' name='purchaserRegisterStatus' value='0' checked title='关'>
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="purchaserCardLimit"><span style='color:red'>*</span>采购商参展证数量上限 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">

										<input class="layui-input" autocomplete="off" lay-verify="required" id="purchaserCardLimit" name="purchaserCardLimit"
										type="text">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="evidenceDelay"><span style='color:red'>*</span>取证凭证延时时间</label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input placeholder="单位为分钟" class="layui-input" lay-verify="required" autocomplete="off" id="evidenceDelay" name="evidenceDelay"
										type="text">										 
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="delegationAddCompanyEndDate"><span style='color:red'>*</span>交易团添加企业截止时间 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="delegationAddCompanyEndDate" name="delegationAddCompanyEndDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="exhibitorsRegistEndDate"><span style='color:red'>*</span>零散参展商注册截止日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="exhibitorsRegistEndDate" name="exhibitorsRegistEndDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="foreignExhibitorsRegistEndDate"><span style='color:red'>*</span>国外零散参展商注册截止日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="foreignExhibitorsRegistEndDate" name="foreignExhibitorsRegistEndDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="certificatesEndDate"><span style='color:red'>*</span>证件添加截止日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="certificatesEndDate" name="certificatesEndDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="certificatesFprEndDate"><span style='color:red'>*</span>嘉宾B、采购商、布撤展证件、布撤展车证截止日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="certificatesFprEndDate" name="certificatesFprEndDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="certificatesExhibitorsEndDate"><span style='color:red'>*</span>零散参展商证件注册截止日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="certificatesExhibitorsEndDate" name="certificatesExhibitorsEndDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="startDate"><span style='color:red'>*</span>展会开始日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" id="startDate" lay-verify="required" name="startDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="endDate"><span style='color:red'>*</span>展会结束日期 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="endDate" name="endDate" type="text" onclick="WdatePicker({skin:'whyGreen',dateFmt:'yyyy-MM-dd'})">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="siteName"><span style='color:red'>*</span>网站标题 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" lay-verify="required" id="siteName" name="siteName"
										type="text">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="siteDescription"> 描述 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<textarea class="layui-textarea" id="siteDescription" name="siteDescription" rows="4"></textarea>
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="siteKeywords"> 关键词 </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block" style="width:80%">
										<input class="layui-input" autocomplete="off" id="siteKeywords" name="siteKeywords"
										type="text">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label" style="width:370px" for="status"> 状态  </label>
								<div class="layui-input-block">
									<div class="layui-input-inline layui-show-xs-block radioborder" style="width:80%">
										<input type='radio' name='status' value='1' title='启用'>
										<input type='radio' name='status' value='0' checked title='禁用'>
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-input-block">
									<button class="layui-btn" lay-filter="add" lay-submit="">
										确认添加
									</button>
								</div>
							</div>
						</form>
					</fieldset>
				</div>
			</div>
		</div>
		<script charset="utf-8" src="/manage/js/jquery.min.js" type="text/javascript"></script>
		<script charset="utf-8" src="/manage/layui/layui.js" type="text/javascript"></script>
		<script charset="utf-8" src="/manage/js/xadmin.js" type="text/javascript"></script>
		<script charset="utf-8" src="/manage/js/vue.js" type="text/javascript"></script>
		<script type="text/javascript" src="/manage/plugins/My97DatePicker/WdatePicker.js"></script>
		<script src="/manage/js/bootstrap.min.js?v=3.3.6"></script>
		<script src="/manage/js/manage/common.js"></script>
		<script charset="UTF-8" type="text/javascript">		
			layui.use('upload', function(){
	  		var upload = layui.upload;
	   		
	  		//上传图片
			var uploadPictrue = upload.render({				
				accept:'images'
				,size:1024
				,exts:'jpg|jpeg|png|gif|bmp'
				,elem: '#uploadPictrue1' //绑定元素
				,url: '/manage/uploadPicture' //上传接
				,before: function(obj){
					/*if($("#exhibitionid").val()==''){
			   			layer.msg('请先选择展会', {icon: 2});
			   			return false;
			   		}*/
					layer.load(); //上传loading
				}
				,done: function(res){
					layer.closeAll('loading');
					if(res.status==1){
						$("#siteHeadLogo").val(res.result);
						$("#yulanimg1").attr("onclick","window.open('"+res.result+"')");
						$("#yulanimg1").show();
						layer.msg('上传成功', {icon: 6});
					}				
				    else{
					 layer.msg(res.msg, {shift: 6});
				    }
				}
				,error: function(){
				  //请求异常回调
				  	layer.msg('接口异常', {shift: 6});
					layer.closeAll('loading');
				}
			  });  
			});
			
			layui.use('upload', function(){
	  		var upload = layui.upload;
	   
	  		//上传图片
			var uploadPictrue = upload.render({
				accept:'images'
				,size:1024
				,exts:'jpg|jpeg|png|gif|bmp'
				,elem: '#uploadPictrue2' //绑定元素
				,url: '/manage/uploadPicture' //上传接
				,before: function(obj){
					layer.load(); //上传loading
				}
				,done: function(res){
					layer.closeAll('loading');
					if(res.status==1){
						$("#siteSmartLogo").val(res.result);
						$("#yulanimg2").attr("onclick","window.open('"+res.result+"')");
						$("#yulanimg2").show();
						layer.msg('上传成功', {icon: 6});
					}				
				    else{
					 layer.msg(res.msg, {shift: 6});
				    }
				}
				,error: function(){
				  //请求异常回调
				  	layer.msg('接口异常', {shift: 6});
					layer.closeAll('loading');
				}
			  });  
			});
		
			layui.use(['form','jquery', 'layer'], function() {
				var form = layui.form, layer = layui.layer;
				loadexhibition(form,'');
				form.render('','test1');
				var $ = layui.jquery;
				form.on('select(demo)', function(data){
					if(data.value!=""){
						var params={};
						params.exhibitionid=data.value;
						$.ajax({
							url : "/manage/system/sysSession/GetLastSessionInfoByExhibitionid",
							data : JSON.stringify(params),
							dataType : "json",
							type : "post",async:false,
							contentType : "application/json",
							success : function(result) {
								if (result.code === 200) {
									if(result.data.siteHeadLogo!=""){
										var siteHeadLogo = result.data.siteHeadLogo;
										$("#siteHeadLogo").val(siteHeadLogo);
										$("#yulanimg1").attr("onclick","window.open('"+siteHeadLogo+"')");
										$("#yulanimg1").show();
									}
									if(result.data.siteHeadLogo!=""){
										var siteSmartLogo = result.data.siteSmartLogo;
										$("#siteSmartLogo").val(siteSmartLogo);
										$("#yulanimg2").attr("onclick","window.open('"+siteSmartLogo+"')");
										$("#yulanimg2").show();
									}
								} else {
									//layer.alert(result.msg);
									$("#siteHeadLogo").val('');
									$("#yulanimg1").attr("onclick","");
									$("#yulanimg1").hide();
									$("#siteSmartLogo").val('');
									$("#yulanimg2").attr("onclick","");
									$("#yulanimg2").hide();
								}
							}
						});
					}
				});
				
				
				//监听提交
				form.on('submit(add)', function(data) {
					//发异步，把数据提交给java
					$.ajax({
						url : "/manage/system/sysSession/save",
						data : JSON.stringify(data.field),
						dataType : "json",
						type : "post",
						contentType : "application/json",
						success : function(result) {
							if (result.code === 200) {
								layer.msg("增加成功", {
									icon : 6,
									time : 500
								}, function() {
									//关闭当前frame
									xadmin.close();
									// 可以对父窗口进行刷新
									xadmin.father_reload();
								});
							} else {
								layer.alert(result.msg);
							}
						}
					});

					return false;
				});

			});
		</script>
	</body>
</html>
