<!DOCTYPE html>
<html class="x-admin-sm" lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>人员证件查询</title>
		<meta content="webkit" name="renderer">
		<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
		<meta content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8" name="viewport"/>
		<link rel="stylesheet" href="/manage/css/xadmin.css">
		<link rel="stylesheet" href="/manage/css/font.css">
		<link href="/manage/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
		<link href="/manage/css/font-awesome.css?v=4.4.0" rel="stylesheet">
		<link href="/manage/css/animate.css" rel="stylesheet">
		<link href="/manage/css/style.css?v=4.1.0" rel="stylesheet">
		<link href="/manage/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
		<script charset="utf-8" src="/manage/js/jquery.min.js" type="text/javascript"></script>
		<script charset="utf-8" src="/manage/layui/layui.js" type="text/javascript"></script>
		<script charset="utf-8" src="/manage/js/xadmin.js" type="text/javascript"></script>
		<script charset="utf-8" src="/manage/js/vue.js" type="text/javascript"></script>
		<style>
			.searchStyle td {
				padding: 0px 2px
			}		
	        .layui-table-cell {
	            height: auto;
	            line-height: 40px;
	        }
    </style>
	</head>
	<body>
		<div class="wrapper wrapper-content  animated fadeInRight">
			<div class="row" id="vmEbsPersonnelcard">
				<div class="col-sm-12">
					<div class="ibox float-e-margins">
						<div class="ibox-title">
							<h5>人员证件查询</h5>
							<div class="ibox-tools">
								<a class="collapse-link"> <i class="fa fa-chevron-up"></i> </a><a class="close-link"> <i class="fa fa-times"></i> </a>
							</div>
						</div>
						<div class="ibox-content">
							<div class="fixed-table-toolbar" style="height:160px;">

								<div class="columns columns-left btn-group pull-left">
									<table class="searchStyle" border="0">
										<tr>
											<td>
											<table>
												<tr>
													<td><b>证件类型：</b></td>
													<td>
														<input type="radio" class="ZJLX" name="ZJLX" checked value="1000">全部
														<input type="radio" class="ZJLX" name="ZJLX" value="1">参展证
														<input type="radio" class="ZJLX" name="ZJLX" value="2">其他人员证件
														<input type="radio"  name="ZJLX" value="3">车辆证件
													</td>
												</tr>
											</table></td>	
											</tr>
											<tr>									
											<td>
											<table>
												<tr>													
														<td style="font-size:14px"><b>打印状态：</b></td>
														<td>
															<input type="radio" class="printstatus" name="printstatus" value="" checked title="全部">
															全部
															<input type="radio" class="printstatus" name="printstatus" value="0" checked title="未打印">
															未打印
															<input type="radio" class="printstatus" name="printstatus" value="1" title="打印中">
															打印中
															<input type="radio" class="printstatus" name="printstatus" value="2" title="完成打印">
															打印
														</td>													
											
													<td style="font-size:14px"><b>审核状态：</b></td>
														<td>
															<input type="radio" class="status" name="status" value="" checked>全部
															<input type="radio" class="status" name="status" value="0">
															未审核
															<input type="radio" class="status" name="status" value="-1">
															审核未通过
															<input type="radio" class="status" name="status" value="1" checked>
															审核通过
														</td>														
											
													<td style="font-size:14px"><b>塑封状态：</b></td>
													<td>
														<input type="radio" class="isplastic" name="isplastic" checked value="">全部
														<input type="radio" class="isplastic" name="isplastic" value="0">未塑封														
														<input type="radio" class="isplastic" name="isplastic" value="1">已塑封
													</td>
											
													<td style="font-size:14px"><b>取证状态：</b></td>
													<td>
														<input type="radio" class="isforensics" name="isforensics" checked value="">全部
														<input type="radio" class="isforensics" name="isforensics" value="0">未取证
														<input type="radio" class="isforensics" name="isforensics" value="1">已取证
													</td>
												</tr>
											</table></td>
										</tr>
										<tr>
											<td colspan="4">
												<table>
													<tr>
														<td style="padding-right:3px">
														<table>
															<tr>
																<td>
																<select id="agent" onchange="ChuLiSelect('agent')" class="form-control input-outline xlselect" style="min-width:160px">
																	<option value="">==代办员==</option>
																</select></td>
															</tr>
														</table></td>
														<td style="padding-right:3px">
														<table>
															<tr>
																<td>
																<select id="jiabinB" onchange="ChuLiSelect('jiabinB')" class="form-control input-outline xlselect" style="min-width:160px">
																	<option value="">==嘉宾B==</option>
																</select></td>
															</tr>
														</table></td>
														<td style="padding-right:3px">
														<table>
															<tr>
																<td>
																<select id="buchezhan" onchange="ChuLiSelect('buchezhan')" class="form-control input-outline xlselect" style="min-width:160px">
																	<option value="">==布撤展==</option>
																</select></td>
															</tr>
														</table></td>
													</tr>
												</table>
											</td>											
										</tr>
										<tr>
											<td colspan="2" style="padding-top:3px">
												<table>
													<tr>
														<td>
														<input name="name" autocomplete="off" class="form-control input-outline" type="text" placeholder="请输入姓名" id="name" style="width:160px;">
														</td>
														<td>
														<input name="companyname" autocomplete="off" class="form-control input-outline" type="text" placeholder="请输入单位名称" id="companyname" style="width:160px;">
														</td>
														<td>
														<input name="companyid" autocomplete="off" class="form-control input-outline" type="text" placeholder="请输入企业Id" id="companyid" style="width:160px;">
														</td>
														<td>
														<input name="platenumber" autocomplete="off" class="form-control input-outline" type="text" placeholder="请输入车牌号码" id="platenumber" style="width:160px;">
														</td>
												<td>
													<button class="btn btn-default btn-outline" type="button" name="search" title="搜索" onclick="reloadTableData()" id="search">
														<i class="glyphicon glyphicon-search"></i>
													</button>
												</td><td>
													<button class="btn btn-default btn-outline" type="button" name="refresh" onclick="location.reload()" title="刷新" id="refresh">
														<i class="glyphicon glyphicon-repeat"></i>
													</button>	</td></tr></table>											
											</td>
										</tr>
									</table>
								</div>
							</div>
							<table id="test" lay-filter="test"></table>
							<input type="hidden" id="hidcompanyid">
							<input type="hidden" id="hidcompanyname">
							<input type="hidden" id="txtvalue">	
							<input type="hidden" id="txtsearchtype">
						</div>
					</div>
				</div>
			</div>
		</div>

		<script src="/manage/js/bootstrap.min.js?v=3.3.6"></script>
		<script src="/manage/js/content.js?v=1.0.0"></script>
		<script src="/manage/js/manage/common.js?v=1.0.0"></script>
		<script src="/manage/js/manage/demo.js?v=1.0.0"></script>
	</body>
	<script type="text/javascript">
		var table;
		layui.use(['form', 'table'], function() {
			table = layui.table;
			var $ = layui.jquery;
			var form = layui.form;
			//loadCardType(form,'cardtype',0,0,'');
			//GetAgentCertificateReview(form,'agent',3);
			$(".ZJLX").change(function(){reloadpage();});
			$(".isplastic").change(function(){reloadpage();});
			$(".status").change(function(){reloadpage();});
			$(".printstatus").change(function(){reloadpage();});
			$(".isforensics").change(function(){reloadpage();});	
			reloadpage();
			function reloadpage(){
				var isplastic = $("input[name='isplastic']:checked").val();
				var isforensics = $("input[name='isforensics']:checked").val();
				var printstatus = $("input[name='printstatus']:checked").val();
				var status = $("input[name='status']:checked").val();
				var ZJLX = $("input[name='ZJLX']:checked").val();
				GetAgentCertificateReviewForQuery(form,'agent',3,printstatus,status,'','',isplastic,isforensics,ZJLX);
				GetPendingDocumentsForQuery(form,'jiabinB',3,'嘉宾证B',4,printstatus,status,'','',isplastic,isforensics,ZJLX);
				GetPendingDocumentsForQuery(form,'buchezhan',3,'布撤展证',3,printstatus,status,'','',isplastic,isforensics,ZJLX);
			}
			table.render({
				elem : '#test',
				url : '/manage/Exhibitors/ebsPersonnelcard/PersonnelCardQuerylist',
				where : {
					status : $("input[name='status']:checked").val(),
					printstatus : $("input[name='printstatus']:checked").val(),
					cardnature : $("input[name='cardnature']:checked").val(),
					companyname : $("#companyname").val(),
					name : $("#name").val(),
					isplastic : $("input[name='isplastic']:checked").val(),
					isforensics : $("input[name='isforensics']:checked").val(),
					ZJLX : $("input[name='ZJLX']:checked").val(),					
				},
				response : {
					statusCode : 1
				},
				page : true,
				cols : [[//表头
				{
					type : 'numbers',
					title : '序号'
				}, {
					align : 'center',
					field : 'chinesename',
					title : '证件类型',
					width : 100
				}
				, {align:'center', field: 'middleid', title: '企业Id',width:70}
				,{
					align : 'center',
					field : 'companyname',
					title : '公司名称'
				}, {
					align : 'center',
					field : 'name',
					title : '姓名',
					templet : function(d) {
						if(d.act=='renyuan'){
							return getUrlName(d.name);
						}
						else{
							return d.name;
						}
					}
				}, {
					align : 'center',
					field : 'imagepath',
					title : '证件照',
					templet : function(d) {
						return getImg(d.imagepath);
					},width:145
				}, {
					align : 'center',
					field : 'agentname',
					title : '代办员',
				}, {
					align : 'center',
					field : 'printstatusname',
					title : '打印状态 ',width:100
				}, {
					field : 'status',
					title : '填报时间',
					templet : function(d) {
						return showTime(d.addtime);
					},
					width : 100
				}, {
					align : 'center',
					field : 'printtime',
					title : '打印时间',
					
				}, {
					align : 'center',
					field : 'plastictime',
					title : '塑封时间',
					
				}, {
					align : 'center',
					field : 'forensicstime',
					title : '取证时间',
					
				}]],
				done : function(res, curr, count) {// 表格渲染完成之后的回调
					var that = this.elem.next();
					if (res.hasOwnProperty("data")) {
						res.data.forEach(function(item, index) {
							if (index % 2 != 0)
								that.find(".layui-table-box tbody tr[data-index='" + index + "']").css("background-color", "#F5F5F5");
						});
					}
				}
			});
			//监听工具条
			table.on('tool(test)', function(obj) {
				var data = obj.data;
				if (obj.event === 'detail') {
					sessionStorage.setItem("viewPersonnelCardProductionId", data.id);
					xadmin.open('人员证件详情', 'PersonnelCardQueryView.html');
				} else if (obj.event === 'repair') {
					//修复
				} else if (obj.event === 'print') {
					//正常打印
				}
			});
		});
		
		function ChuLiSelect(inputid){
			$(".xlselect").each(function(){
				if($(this).attr("id")!=inputid){
					$(this).val('');
				}
			});
			$("#txtvalue").val($("#"+inputid).val());
			$("#txtsearchtype").val(inputid);
		}

		//重新加载数据
		function reloadTableData() {
			var agent = "";
			var cardtype = "";
			var companyname = "";				
			var searchType = $("#txtsearchtype").val();
			if(searchType=='agent'){//选择代办员时
				agent = $("#agent").val();
				//cardtype = $("input[name='cardtype']:checked").val();
				companyname = $("#companyname").val();
			} else if(searchType==''){
				companyname=$("#companyname").val();
			}	
			else{
				var val = $("#"+searchType).val();	
				if(typeof(val) != "undefined"){		
					if(val != ''){
						var strArgs = val.split('|');
						companyname = strArgs[0];
						cardtype = strArgs[1];
					}
				}
			}
			table.reload('test', {
				method : 'get',
				page : {
					curr : 1
				},
				url : '/manage/Exhibitors/ebsPersonnelcard/PersonnelCardQuerylist',
				where : {
					status : $("input[name='status']:checked").val(),
					printstatus : $("input[name='printstatus']:checked").val(),
					cardnature : $("input[name='cardnature']:checked").val(),
					companyname : companyname,
					name : $("#name").val(),
					isplastic : $("input[name='isplastic']:checked").val(),
					isforensics : $("input[name='isforensics']:checked").val(),
					ZJLX : $("input[name='ZJLX']:checked").val(),
					agent:agent,
					companyid:$("#companyid").val(),
					platenumber:$("#platenumber").val(),
					cardtype:cardtype
				}
			});
		}

	</script>
</html>